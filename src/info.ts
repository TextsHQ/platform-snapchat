import { MessageDeletionMode, Attribute, PlatformInfo } from '@textshq/platform-sdk'

import { supportedReactions } from './constants'

const info: PlatformInfo = {
  name: 'snapchat',
  version: '0.0.1',
  displayName: 'Snapchat',
  icon: `<svg width="1em" height="1em" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#cp)">
<rect width="16" height="16" rx="5" fill="#FFFC00"/>
<path d="M13.3738 10.9027C11.4342 9.96384 11.1251 8.51424 11.1114 8.40672C11.0947 8.27648 11.0758 8.17408 11.2195 8.0416C11.3581 7.9136 11.9728 7.53312 12.1434 7.41408C12.4253 7.21696 12.5494 7.02016 12.4579 6.77824C12.3939 6.61088 12.2381 6.54784 12.0739 6.54784C12.0221 6.548 11.9705 6.55379 11.92 6.56512C11.6102 6.63232 11.3094 6.78752 11.1354 6.82944C11.1144 6.83483 11.093 6.83773 11.0714 6.83808C10.9786 6.83808 10.9434 6.7968 10.9523 6.68512C10.9741 6.34656 11.0202 5.68576 10.9667 5.06848C10.8934 4.2192 10.6195 3.7984 10.2947 3.42624C10.1376 3.24576 9.408 2.4704 8 2.4704C6.592 2.4704 5.86336 3.24576 5.7072 3.424C5.38144 3.79616 5.10784 4.21696 5.0352 5.06624C4.98176 5.68352 5.02976 6.344 5.0496 6.68288C5.056 6.78912 5.02336 6.83584 4.93056 6.83584C4.90896 6.83547 4.88748 6.83257 4.86656 6.8272C4.6928 6.78528 4.392 6.63008 4.08224 6.56288C4.03171 6.55155 3.9801 6.54576 3.92832 6.5456C3.76352 6.5456 3.60832 6.6096 3.54432 6.776C3.4528 7.01792 3.57632 7.21472 3.8592 7.41184C4.02976 7.53088 4.64448 7.91104 4.78304 8.03936C4.9264 8.17184 4.90784 8.27424 4.8912 8.40448C4.87744 8.5136 4.568 9.9632 2.6288 10.9005C2.5152 10.9555 2.32192 11.072 2.66272 11.2602C3.19776 11.5558 3.55392 11.5242 3.83072 11.7024C4.0656 11.8538 3.92672 12.1802 4.0976 12.2979C4.30752 12.4429 4.928 12.2877 5.7296 12.5523C6.4016 12.7738 6.80992 13.3994 8.0016 13.3994C9.19328 13.3994 9.61344 12.7709 10.2736 12.5523C11.0736 12.2877 11.6954 12.4429 11.9056 12.2979C12.0762 12.1802 11.9376 11.8538 12.1725 11.7024C12.4493 11.5242 12.8051 11.5558 13.3405 11.2602C13.6806 11.0742 13.4874 10.9578 13.3738 10.9027Z" fill="white"/>
<path d="M14.2176 10.7923C14.1306 10.5555 13.9648 10.4288 13.776 10.3238C13.7405 10.303 13.7078 10.2864 13.68 10.2736C13.6237 10.2445 13.5661 10.2163 13.5088 10.1866C12.9203 9.87455 12.4608 9.48095 12.1421 9.01439C12.0516 8.88305 11.9731 8.74382 11.9075 8.59839C11.8803 8.52063 11.8816 8.47647 11.9011 8.43615C11.9205 8.40509 11.9461 8.37839 11.9763 8.35775C12.0774 8.29087 12.1818 8.22303 12.2525 8.17727C12.3786 8.09567 12.4784 8.03103 12.5427 7.98527C12.7843 7.81631 12.9533 7.63679 13.0589 7.43615C13.1326 7.29753 13.1755 7.14467 13.1849 6.98796C13.1942 6.83126 13.1697 6.67438 13.113 6.52799C12.953 6.10687 12.5552 5.84543 12.0733 5.84543C11.9716 5.84534 11.8703 5.85606 11.7709 5.87743C11.7443 5.88319 11.7178 5.88927 11.6918 5.89599C11.6963 5.60799 11.6899 5.30399 11.6643 5.00479C11.5734 3.95295 11.2051 3.40159 10.8211 2.96191C10.5752 2.68639 10.2856 2.45329 9.96384 2.27199C9.38112 1.93919 8.72032 1.77023 8 1.77023C7.27968 1.77023 6.62208 1.93919 6.03872 2.27199C5.71619 2.45335 5.42597 2.68691 5.17984 2.96319C4.79584 3.40287 4.42752 3.95519 4.33664 5.00607C4.31104 5.30527 4.30464 5.61087 4.3088 5.89727C4.28288 5.89055 4.25664 5.88447 4.23008 5.87871C4.1307 5.85734 4.02933 5.84662 3.92768 5.84671C3.44544 5.84671 3.04704 6.10815 2.88768 6.52927C2.83072 6.67572 2.80595 6.83271 2.81506 6.98958C2.82417 7.14645 2.86695 7.29953 2.94048 7.43839C3.0464 7.63903 3.21536 7.81855 3.45696 7.98751C3.52096 8.03231 3.62112 8.09695 3.7472 8.17951C3.81536 8.22367 3.91488 8.28831 4.01248 8.35295C4.04663 8.37503 4.07565 8.40416 4.0976 8.43839C4.11808 8.48031 4.11872 8.52543 4.08832 8.60863C4.02366 8.751 3.94645 8.88733 3.8576 9.01599C3.54592 9.47199 3.09984 9.85855 2.53024 10.168C2.22848 10.328 1.91488 10.4349 1.7824 10.7949C1.68256 11.0666 1.74784 11.3757 2.0016 11.6362C2.09473 11.7334 2.20275 11.8151 2.3216 11.8784C2.56889 12.0143 2.83185 12.1195 3.10464 12.1917C3.16093 12.2062 3.21437 12.2301 3.26272 12.2624C3.3552 12.3434 3.34208 12.4653 3.46528 12.6438C3.52712 12.7361 3.6057 12.816 3.69696 12.8794C3.95552 13.0579 4.24608 13.0691 4.55392 13.081C4.832 13.0915 5.1472 13.1037 5.5072 13.2224C5.65632 13.2717 5.8112 13.367 5.99072 13.4784C6.42176 13.7434 7.01184 14.1059 7.99936 14.1059C8.98688 14.1059 9.58112 13.7414 10.0154 13.4755C10.1936 13.3661 10.3475 13.2717 10.4925 13.2237C10.8525 13.1046 11.1677 13.0928 11.4458 13.0822C11.7536 13.0704 12.0442 13.0592 12.3027 12.8806C12.4108 12.8053 12.5008 12.7069 12.5664 12.5926C12.655 12.4419 12.6528 12.3366 12.736 12.263C12.7814 12.2323 12.8315 12.2093 12.8845 12.1952C13.161 12.1228 13.4275 12.0166 13.6781 11.879C13.8043 11.8113 13.918 11.7223 14.0141 11.616L14.0173 11.6122C14.2554 11.3574 14.3152 11.0573 14.2176 10.7923ZM13.3398 11.264C12.8045 11.5597 12.4486 11.528 12.1718 11.7062C11.9366 11.8576 12.0758 12.184 11.905 12.3018C11.695 12.4467 11.0746 12.2915 10.273 12.5562C9.61184 12.7747 9.19008 13.4032 8.00096 13.4032C6.81184 13.4032 6.4 12.776 5.728 12.5546C4.928 12.2899 4.30624 12.4451 4.096 12.3002C3.92544 12.1824 4.064 11.856 3.82912 11.7046C3.552 11.5264 3.19616 11.5581 2.66112 11.264C2.32032 11.0758 2.5136 10.9594 2.6272 10.9043C4.5664 9.96543 4.87584 8.51583 4.8896 8.40831C4.90624 8.27807 4.9248 8.17567 4.78144 8.04319C4.64288 7.91519 4.02816 7.53471 3.8576 7.41567C3.57536 7.21855 3.4512 7.02175 3.54272 6.77983C3.60672 6.61247 3.76288 6.54943 3.92672 6.54943C3.9785 6.54959 4.03011 6.55539 4.08064 6.56671C4.3904 6.63391 4.6912 6.78911 4.86496 6.83103C4.88588 6.8364 4.90736 6.8393 4.92896 6.83967C5.02176 6.83967 5.0544 6.79295 5.048 6.68671C5.02816 6.34783 4.98016 5.68735 5.0336 5.07007C5.10688 4.22079 5.38048 3.79999 5.7056 3.42783C5.86176 3.24895 6.59552 2.47359 7.99872 2.47359C9.40192 2.47359 10.1376 3.24575 10.2938 3.42399C10.6192 3.79615 10.8931 4.21695 10.9658 5.06623C11.0192 5.68351 10.9731 6.34431 10.9514 6.68287C10.944 6.79455 10.9776 6.83583 11.0704 6.83583C11.092 6.83549 11.1135 6.83259 11.1344 6.82719C11.3085 6.78527 11.6093 6.63007 11.919 6.56287C11.9696 6.55155 12.0212 6.54575 12.073 6.54559C12.2378 6.54559 12.393 6.60959 12.457 6.77599C12.5485 7.01791 12.425 7.21471 12.1424 7.41183C11.9718 7.53087 11.3571 7.91103 11.2186 8.03935C11.0749 8.17183 11.0938 8.27423 11.1104 8.40447C11.1242 8.51359 11.4333 9.96319 13.3728 10.9005C13.4874 10.9578 13.6806 11.0742 13.3398 11.264Z" fill="black"/>
</g>
<defs>
<clipPath id="cp">
<rect width="16" height="16" fill="white"/>
</clipPath>
</defs>
</svg>
`,
  loginMode: 'browser',
  reactions: {
    supported: supportedReactions,
  },
  deletionMode: MessageDeletionMode.DELETE_FOR_SELF,
  browserLogin: {
    // url: 'https://accounts.snapchat.com/accounts/v2/login',
    url: 'https://accounts.snapchat.com/accounts/v2/login?continue=%2Faccounts%2Fsso%3Freferrer%3Dhttps%253A%252F%252Fweb.snapchat.com%252F%26client_id%3Dweb-calling-corp--prod',
    // authCookieName: '__Host-sc-a-session', // and __Host-sc-a-nonce
    // authCookieName: '__Host-sc-a-nonce',
    runJSOnNavigate: `
      // // hide close button on login page on mobile
      // const ss = document.createElement('style')
      // ss.innerText = '[aria-label="Close"]{display:none!important}'
      // document.head.appendChild(ss)
    `,
  },
  typingDurationMs: 3000,
  attributes: new Set([
    // Attribute.GROUP_THREAD_CREATION_REQUIRES_MESSAGE,
    // Attribute.NO_SUPPORT_GROUP_REMOVE_PARTICIPANT,
    // Attribute.SUBSCRIBE_TO_THREAD_SELECTION,
    // Attribute.SUPPORTS_REQUESTS_INBOX,
    // Attribute.SUPPORTS_MOVING_THREAD_TO_INBOX,
    // Attribute.SUPPORTS_GROUP_IMAGE_CHANGE,
    // Attribute.SUPPORTS_DELETE_THREAD,
    // Attribute.SORT_MESSAGES_ON_PUSH,
    // Attribute.CAN_MESSAGE_USERNAME,
    // Attribute.SEARCH_ALL_USERS_FOR_GROUP_MENTIONS,
    // Attribute.SUPPORTS_REPORT_THREAD,
    // Attribute.SUBSCRIBE_TO_ONLINE_OFFLINE_ACTIVITY,
    // Attribute.SUPPORTS_PUSH_NOTIFICATIONS,
    // Attribute.CAN_FETCH_LINK_PREVIEW,
    // Attribute.CAN_REMOVE_LINK_PREVIEW,
  ]),
  attachments: {
    gifMimeType: 'image/gif',
    noSupportForAudio: true,
    noSupportForFiles: true,
    supportsCaption: true,

    // https://developer.twitter.com/en/docs/twitter-api/v1/media/upload-media/uploading-media/media-best-practices
    maxSize: {
      // media_upload_init(media_type=image/jpeg, media_category=dm_image): File size exceeds 5242880 bytes.
      image: 5 * 1024 * 1024,
      // media_upload_init(media_type=video/mp4, media_category=dm_video): File size exceeds 536870912 bytes.
      video: 512 * 1024 * 1024,
    },
  },
  prefs: {
    // show_notifications_thread: {
    //   label: 'Show Twitter like/retweet/mentions notifications as a thread',
    //   type: 'checkbox',
    //   default: false,
    // },
    // show_only_mentions_in_notifications_thread: {
    //   label: 'Show only mentions in Notifications thread',
    //   type: 'checkbox',
    //   default: false,
    // },
  },
  notifications: {
    web: {
      // vapidKey: 'BF5oEo0xDUpgylKDTlsd8pZmxQA1leYINiY-rSscWYK_3tWAkz4VMbtf1MLE_Yyd6iII6o-e3Q9TCN5vZMzVMEs',
    },
  },
  // getUserProfileLink: ({ username }) =>
  //   username && `https://twitter.com/${username}`,
}

export default info
